library(readr)
library(tvcure)

if(!exists("icow_part_cyr_ct")) icow_part_cyr_ct <- read_csv("./data/icow_part_cyr_ct.csv")


cl <- makeCluster(4, "SOCK"); registerDoSNOW(cl)

m <- tvcure(Surv(y0, year, agreeiss) ~ lterugtdepmax + lag_ln_trade + 
              + lag_ln_gdp_chal + lag_ln_gdp_tgt + lag_ln_gdpcap_chal + lag_ln_gdpcap_tgt + 
              lpol_chal * lpol_tgt + lcaprat + contdir,
            cureform = ~ lterugtdepmax + lag_ln_trade + 
              + lag_ln_gdp_chal + lag_ln_gdp_tgt + lag_ln_gdpcap_chal + lag_ln_gdpcap_tgt + 
              lpol_chal * lpol_tgt + lcaprat + ldefense, data = icow_part_cyr_ct, var = T, brglm = T)
    
              lag_ln_trade + lag_ln_deptotmax +                  + 
              lpol_chal  * lpol_tgt +
              icowsal + 
              recnowt + recyeswt + recmidwt +
              lcaprat + ldefense + contdir,
            cureform = ~ lterugtdepmax + lpol_chal * lpol_tgt + lcaprat + ldefense, 
            data = icow_part_cyr_ct, 
            var = F, parallel = F, brglm = T
)


m <- tvcure(Surv(y0, year, attanyp) ~ lterugtdepmax + lag_ln_trade + 
             + 
              lpol_chal * lpol_tgt + lcaprat + contdir,
            cureform = ~ lterugtdepmax + lag_ln_trade + 
              + lag_ln_gdp_chal + lag_ln_gdp_tgt + lag_ln_gdpcap_chal + lag_ln_gdpcap_tgt + 
              lpol_chal * lpol_tgt + lcaprat + ldefense, data = icow_part_cyr_ct, var = T, brglm = T)


att_dy <- brglm(attanyp ~ lterugtdepmax + lag_ln_trade + lag_ln_deptotmax + 
                  lag_gdp_chal + lag_gdp_tgt + lag_gdpcap_chal + lag_gdpcap_tgt + 
                  lpol_chal  * lpol_tgt +
                  icowsal + 
                  recnowt + recyeswt + recmidwt +
                  lcaprat + ldefense + contdir + 
